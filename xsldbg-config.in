    #! /bin/sh

    prefix=@prefix@


    usage (){
	    cat << EOF
    Usage : xsldbg-config [OPTION]

    Where option value can be

      -- prefix=DIR     Change the prefix of xsldbg installation ($prefix)
      --mode=MODE       What type of threads/notification is to be used
	  Where MODE is either  :
	     QT    : use QT libraries
	     GNOME : user GNOME libaries (not implemented)
      --option=OPTION   Options for the compiled xsldbg
	  When OPTION is either :
             THREADED  : Is thread support present (false/true)
  
      --libs            Display flags of required libraries for linking
      --cflags          Display flags for compiling
      --version         Display version of xsldbg
      --help            Display this message 
EOF

    exit $1

    }


    if test $# -eq 0 
    then
      usage 1
    fi

    mode="QT"
    haveQT=@HAVE_QT@
    QTDIR="`echo $QTDIR`"
		qt_extra_libs=" -lqtnotifier -lpthread"
    haveGNOME=@HAVE_GNOME@
    GNOMEDIR=/opt/gnome
	  gnome_extra_libs=""
    cflags=
    libs=
    threadLibs=" @THREAD_LIBS@ "	
    threadCFlags=
		libxslt_libs="@LIBXSLT_LIBS@ -lexslt"
		libxslt_cflags="@LIBXSLT_CFLAGS@"
    xsldbg_libs=" @XSLDBG_LIBS@ "
	  xsldbg_cflags="@XSLDBG_CFLAGS@"
    havePThread=@HAVE_PTHREAD@
    threadsupport=false
    if test "x${haveQT}" = "x1" -a  "x${havePThread}" = "x1"
    then
       threadsupport=true	   	
		fi

	  if test "x$threadsupport" = "xfalse"
	  then
		  # this should not happen as I already check during configuration of xsldbg
		  echo "xsldbg does not support a thread on this system"
			exit 1
		fi

    while test $# -gt 0; do
       case "$1" in 
       -*=*) optArgument=`echo "$1" | sed 's/[-_a-zA-Z0-9]*=//'`;;
       *) optArgument= ;;
      esac     
      
    case "$1" in
	--prefix=*)
	    prefix=$optArgument;;	

	--version) 
	     echo @VERSION@
	     exit 0;;

	--help)
	   usage 0;;

	--mode=*)
	    mode=$optArgument
	    case "$optArgument" in
	       QT) 
		 if test "x${haveQT}" != "x1"
		 then
		    echo "QT installation not present"
		    exit 1
		 else
		  mode="QT"
		 fi;;

	       GNOME) 
		 if test "x${haveGNOME}" != "x1"
		 then
		    echo "GNOME installation not present"
		    exit 1
		 else
		    mode="GNOME"
		    echo "GNOME support not implemented"
		    exit 1
		 fi;;

	      *) echo "Unknown mode $1"
		 exit 1 		

	    esac;;

	--option=*)
	   case "$optArgument" in
	     THREADED) echo "$threadsupport";;

              *) echo "Unspported argument $optArgument to --option"

	   esac;;

	 --cflags)
	    case "$mode" in
	      QT)
	       # echo "-I$prefix/include -I$QTDIR/include $threadCFlags $libxslt_cflags"
	       echo "$xsldbg_cflags"
	      ;;
	      
	      GNOME)
		    echo " -I$prefix/include /opt/gnome/include"
	    esac
	    ;;


	 --libs)	
	    case "$mode" in
	    QT)
				# echo "-L$prefix/lib -L$QTDIR/lib $threadLibs $libxslt_libs"	
	      echo " $qt_extra_libs $xsldbg_libs "
	    ;;
	 
	    GNOME)
				#echo "-L$prefix/lib -L$threadLibs /opt/gnome/lib"
		     echo " $gnome_extra_libs $xsldbg_libs "

	    esac;;

	*) echo "Unknown option $1" 

	 esac
	shift
   done

exit 0